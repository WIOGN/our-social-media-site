let express,mongoose,cors,path,socketio,fs,upload,getSmall,getImage,socketComment,socketHome;_82a‍.w("express",[["default",["express"],function(v){express=v}]]);_82a‍.w("mongoose",[["default",["mongoose"],function(v){mongoose=v}]]);_82a‍.w("cors",[["default",["cors"],function(v){cors=v}]]);_82a‍.w("path",[["default",["path"],function(v){path=v}]]);_82a‍.w("socket.io",[["default",["socketio"],function(v){socketio=v}]]);_82a‍.w("fs",[["default",["fs"],function(v){fs=v}]]);_82a‍.w("./api/routes/upload",[["default",["upload"],function(v){upload=v}]]);_82a‍.w("./api/routes/getSmall",[["default",["getSmall"],function(v){getSmall=v}]]);_82a‍.w("./api/routes/getNormal",[["default",["getImage"],function(v){getImage=v}]]);_82a‍.w("./api/routes/socketComment",[["default",["socketComment"],function(v){socketComment=v}]]);_82a‍.w("./api/routes/socketHome",[["default",["socketHome"],function(v){socketHome=v}]]);












fs.mkdir('./uploads/originals', { recursive: true });
fs.mkdir('./uploads/smalls', { recursive: true });

var app = express();
app.use(cors())

var connection = mongoose.connect('mongodb://mongo:27017', { useUnifiedTopology: true });
var db = mongoose.connection;

db.on('error', function () {
    console.log("MongoDB Error...");
});

db.once('open', function () {
    console.log("MongoDB Connection Sucessful!!!");
});

// Use Routes
app.use('/api/upload', upload);
app.use('/api/getsmall', getSmall);
app.use('/api/getimage', getImage);

//Production mode here
app.use(express.static('frontend/build'));

app.get('*', (req, res) => {
    res.sendFile(path.resolve(__dirname, 'frontend', 'build', 'index.html'));
});


var server = app.listen(8000, () => console.log('Listening on port 8000..'));
var io = socketio(server);
socketComment(io);
socketHome(io);